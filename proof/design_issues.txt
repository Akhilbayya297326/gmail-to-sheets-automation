Design Decisions & Challenges
1. OAuth Flow
I used the InstalledAppFlow strategy. The first run opens a browser for user consent. The credentials are then saved locally to token.json for future runs without re-authentication.

2. Duplicate Prevention (State Management)
To satisfy the "Append only new emails" requirement, I used a Label-Based Approach:

The script fetches only emails with q='is:unread'.

After successfully parsing and appending the email to the Sheet, the script modifies the label to remove UNREAD.

Benefit: If the script crashes mid-way, processed emails are safe, and unprocessed ones remain unread for the next run.

3. Limitations
The script currently processes only the "Inbox" label.

It assumes the Google Sheet structure (Columns A-D) is pre-existing.